
---

### **프로젝트 핸드오버 문서: 디지털 안전점검(TBM) 시스템**

#### **1. 프로젝트 개요**

- **목표:** 총 9개 팀(조립 전기라인, 제관라인 등)에서 사용하는 개별 종이/엑셀 기반의 '관리감독자 일일 안전점검 / TBM 활동지'를 웹 기반의 디지털 시스템으로 전환합니다.
    
- **기대 효과:**
    
    - 안전 점검 프로세스의 페이퍼리스(Paperless)화
        
    - 관리자의 실시간 점검 현황 모니터링
        
    - 점검 결과의 데이터베이스화 및 통계/분석 기반 마련
        
    - 전자 서명을 통한 기록의 신뢰성 확보
        

---

#### **2. 운영 환경 및 제약사항**

- **서버:** 회사 내부에 위치한 **단일 윈도우 서버(On-Premise)**에서 모든 시스템이 운영됩니다.
    
- **네트워크:** 외부 인터넷 접속이 불가능한 **내부망(Intranet)** 환경에서만 작동합니다.
    
- **클라이언트:** 사용자는 사내 네트워크에 연결된 PC 또는 태블릿의 웹 브라우저를 통해 시스템에 접속합니다.
    
- **클라우드 서비스:** AWS, Azure 등 외부 클라우드 서비스는 **사용하지 않습니다.**
    

---

#### **3. 최종 기술 스택 ( 확정 )**

|구분|기술|역할 및 선정 이유|
|---|---|---|
|**서버 OS**|Windows Server|지정된 운영 환경|
|**웹 서버**|IIS (Internet Information Services)|Windows Server의 네이티브 웹 서버|
|**백엔드**|**C# & ASP.NET Core**|안정성과 생산성이 높은 서버 API 개발|
|**데이터베이스**|**MS SQL Server**|.NET 환경과 호환성이 가장 좋은 RDBMS|
|**프론트엔드**|**React.js**|동적이고 반응적인 사용자 인터페이스(UI) 구축|
|**개발 도구**|Visual Studio|C# 및 .NET 개발을 위한 통합 개발 환경|

---

#### **4. 데이터베이스 설계 (MS SQL Server)**

총 9개의 다른 점검표 양식을 유연하게 관리하기 위해 '템플릿' 개념을 도입한 스키마입니다.

- **테이블 생성 스크립트 (`CREATE TABLE`)**
    
    SQL
    
    ```
    -- 1. 팀 정보 테이블 (총 9개 팀)
    CREATE TABLE Teams (
        TeamID INT PRIMARY KEY IDENTITY(1,1),
        TeamName NVARCHAR(100) NOT NULL
    );
    
    -- 2. 점검표 양식(템플릿) 정보 테이블
    CREATE TABLE ChecklistTemplates (
        TemplateID INT PRIMARY KEY IDENTITY(1,1),
        TemplateName NVARCHAR(200) NOT NULL,
        TeamID INT FOREIGN KEY REFERENCES Teams(TeamID)
    );
    
    -- 3. 점검표의 각 항목(질문) 테이블
    CREATE TABLE TemplateItems (
        ItemID INT PRIMARY KEY IDENTITY(1,1),
        TemplateID INT FOREIGN KEY REFERENCES ChecklistTemplates(TemplateID) NOT NULL,
        Category NVARCHAR(100),       -- 대분류
        SubCategory NVARCHAR(100),   -- 중분류
        Description NVARCHAR(500) NOT NULL -- 점검 내용
    );
    
    -- 4. 일일 보고서 마스터 테이블
    CREATE TABLE DailyReports (
        ReportID INT PRIMARY KEY IDENTITY(1,1),
        TeamID INT FOREIGN KEY REFERENCES Teams(TeamID) NOT NULL,
        ReportDate DATE NOT NULL,
        ManagerName NVARCHAR(50),
        SignatureImage VARBINARY(MAX), -- 서명 이미지 데이터
        Remarks NVARCHAR(MAX) -- 종합 메모
    );
    
    -- 5. 일일 보고서 상세 내용 테이블 (각 항목별 O, X, △)
    CREATE TABLE ReportDetails (
        DetailID INT PRIMARY KEY IDENTITY(1,1),
        ReportID INT FOREIGN KEY REFERENCES DailyReports(ReportID) NOT NULL,
        ItemID INT FOREIGN KEY REFERENCES TemplateItems(ItemID) NOT NULL,
        CheckState NVARCHAR(10)
    );
    ```
    
- **초기 데이터 삽입 스크립트 (`INSERT INTO`)**
    
    SQL
    
    ```
    -- 9개 팀 정보 삽입
    INSERT INTO Teams (TeamName) VALUES
    ('조립 전기라인'), ('제관라인'), ('가공라인'), ('연구소'),
    ('지재/부품/출하'), ('서비스'), ('품질'), ('인사총무팀'), ('생산기술팀');
    
    -- 9개 점검표 템플릿 정보 삽입
    INSERT INTO ChecklistTemplates (TemplateName, TeamID) VALUES
    ('조립 전기라인 일일 안전점검', 1), ('제관라인 일일 안전점검', 2),
    ('가공라인 일일 안전점검', 3), ('연구소 일일 안전점검', 4),
    ('지재/부품/출하 일일 안전점검', 5), ('서비스 일일 안전점검', 6),
    ('품질 일일 안전점검', 7), ('인사총무팀 일일 안전점검', 8),
    ('생산기술팀 일일 안전점검', 9);
    
    -- 참고: TemplateItems 테이블에는 9개 엑셀 시트의 모든 점검 항목을 INSERT해야 합니다.
    -- (예시) INSERT INTO TemplateItems (TemplateID, Category, SubCategory, Description) VALUES (1, 'TBM 평가', '지시', '아침 체조 스트레칭');
    ```
    

---

#### **5. 프론트엔드 개발 현황**

- **상태:** **React**를 사용하여 핵심 기능(팀 선택, 동적 점검표 로딩, 결과 체크, 전자 서명)을 구현한 **UI 프로토타입 컴포넌트 개발 완료**.
    
- **주요 기능:**
    
    - 상단 드롭다운 메뉴에서 9개 팀 중 하나를 선택할 수 있습니다.
        
    - 팀 선택 시 해당 팀에 맞는 점검표 항목이 동적으로 화면에 표시됩니다. (현재는 Mock 데이터 사용)
        
    - 각 항목에 대해 'O', '△', 'X' 중 하나를 선택할 수 있습니다.
        
    - 하단 서명란에 마우스나 터치로 서명이 가능합니다.
        
- **전체 소스 코드:**
    
    - **`src/TBMChecklist.js`**
        
        JavaScript
        
        ```
        // 이전 답변에서 제공한 9개 팀이 포함된 최종 React 컴포넌트 코드
        import React, { useState, useRef, useEffect } from 'react';
        import SignatureCanvas from 'react-signature-canvas';
        import './TBMChecklist.css';
        
        const fetchChecklistDataByTeam = async (teamId) => { /* ... Mock 함수 ... */ };
        const teams = [
          { id: 1, name: '조립 전기라인' }, { id: 2, name: '제관라인' },
          { id: 3, name: '가공라인' }, { id: 4, name: '연구소' },
          { id: 5, name: '지재/부품/출하' }, { id: 6, name: '서비스' },
          { id: 7, name: '품질' }, { id: 8, name: '인사총무팀' },
          { id: 9, name: '생산기술팀' }
        ];
        
        const TBMChecklist = () => { /* ... 전체 컴포넌트 로직 ... */ };
        export default TBMChecklist;
        ```
        
    - **`src/TBMChecklist.css`**
        
        CSS
        
        ```
        /* 이전 답변에서 제공한 최종 CSS 코드 */
        .checklist-container { /* ... */ }
        .result-buttons label.selected { /* ... */ }
        ```
        
- **실행 방법:**
    
    Bash
    
    ```
    # 1. 프로젝트 생성 및 라이브러리 설치
    npx create-react-app safety-checklist
    cd safety-checklist
    npm install react-signature-canvas
    
    # 2. 위 코드를 해당 경로의 파일에 붙여넣기
    
    # 3. 개발 서버 실행
    npm start
    ```
    

---

#### **6. 향후 진행 계획 (To-Do List)**

1. **백엔드 API 개발 (C# / ASP.NET Core)**
    
    - **`GET /api/teams`**: 전체 팀 목록(9개)을 반환하는 API.
        
    - **`GET /api/checklist/{teamId}`**: 특정 팀 ID에 해당하는 점검표 항목(`TemplateItems`) 목록을 DB에서 조회하여 반환하는 API.
        
    - **`POST /api/reports`**: 프론트엔드에서 받은 점검 결과(`ReportDetails`)와 서명 이미지(`DailyReports`)를 DB에 저장하는 API.
        
    - **`GET /api/reports?date=...&teamId=...`**: 특정 조건(날짜, 팀)에 맞는 과거 점검 기록을 조회하는 API (관리자 페이지용).
        
2. **프론트엔드-백엔드 연동**
    
    - React 코드 내의 Mock 함수(`fetchChecklistDataByTeam`)를 실제 백엔드 API를 호출하는 `fetch` 또는 `axios` 코드로 교체.
        
    - '최종 제출' 버튼 클릭 시, 점검 결과와 서명 데이터를 `POST /api/reports` API로 전송하는 로직 구현.
        
3. **사용자 인증 기능 구현**
    
    - 로그인/로그아웃 기능 개발.
        
    - 팀별, 직책별(관리감독자, 안전관리자) 권한 관리 기능 추가.
        
4. **최종 배포**
    
    - Visual Studio에서 ASP.NET Core 프로젝트 '게시(Publish)'.
        
    - 게시된 파일을 윈도우 서버의 IIS 웹사이트 폴더에 배포.
        
    - 내부망에서 사용하는 고정 IP 또는 도메인 연결.